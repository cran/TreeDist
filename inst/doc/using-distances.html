<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Martin R. Smith" />


<title>Contextualizing tree distances</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Contextualizing tree distances</h1>
<h4 class="author"><a href="https://smithlabdurham.github.io/">Martin R. Smith</a></h4>



<p>Once you understand <a href="Using-TreeDist.html">how to use “TreeDist”</a> to calculate tree distances, the next step is to provide some context for the calculated distances.</p>
<div id="normalizing" class="section level2">
<h2>Normalizing</h2>
<p>The maximum value of most tree distance metrics scales with the size of the trees being compared. Typically, the resolution of the trees also impacts the range of possible values. As such, it can be difficult to interpret the tree distance value without suitable context.</p>
<p>Normalizing a distance metric is one way to render its meaning more obvious. Selecting an appropriate normalizing constant may require careful consideration of the purpose to which a tree distance metric is being put.</p>
<p>The default normalization behaviour of each function when <code>normalize = TRUE</code> is listed in the <a href="../reference/index.html">function reference</a>, or can be viewed by typing <code>?FunctionName</code> in the R terminal.</p>
<div id="nye-et-al.-tree-similarity" class="section level3">
<h3>Nye <em>et al.</em> tree similarity</h3>
<p>Let’s work through a simple example using the Nye <em>et al</em>. <span class="citation">(2006)</span> similarity metric to compare two imperfectly-resolved trees.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;TreeDist&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>tree1 <span class="ot">&lt;-</span> ape<span class="sc">::</span><span class="fu">read.tree</span>(<span class="at">text =</span> <span class="st">&#39;(A, ((B, ((C, D), (E, F))), (G, (H, (I, J, K)))));&#39;</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>tree2 <span class="ot">&lt;-</span> ape<span class="sc">::</span><span class="fu">read.tree</span>(<span class="at">text =</span> <span class="st">&#39;(A, (B, (C, D, E, (J, K)), (F, (G, H, I))));&#39;</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">VisualizeMatching</span>(NyeSimilarity, tree1, tree2,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Plot =</span> TreeDistPlot, <span class="at">matchZeros =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="90%" style="display: block; margin: auto;" /></p>
<p>This is a nice metric to start with, because the maximum similarity between each pair of splits is defined as one. (Astute readers might worry that the minimum similarity is greater than zero – that’s a harder problem to overcome.)</p>
<p>As such, the maximum similarity possible between two 11-leaf trees is <a href="https://ms609.github.io/TreeTools/reference/NSplits.html"><code>NSplits(11)</code></a> = 8.</p>
<p>Normalizing against this value tells us how similar the two trees are, compared to two identical eleven-leaf binary trees.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NyeSimilarity</span>(tree1, tree2, <span class="at">normalize =</span> <span class="cn">FALSE</span>) <span class="sc">/</span> <span class="dv">8</span></span></code></pre></div>
<pre><code>## [1] 0.2744048</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NyeSimilarity</span>(tree1, tree2, <span class="at">normalize =</span> <span class="dv">8</span>)</span></code></pre></div>
<pre><code>## [1] 0.2744048</code></pre>
<p>This approach will result in a similarity score less than one if two trees are identical, but not fully resolved (i.e. binary).<br />
As such, we might prefer to compare the tree similarity to the maximum score possible for two trees of the specified resolution. This value is given by the number of splits in the least resolved of the two trees:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NyeSimilarity</span>(tree1, tree2,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">normalize =</span> <span class="fu">min</span>(TreeTools<span class="sc">::</span><span class="fu">NSplits</span>(<span class="fu">list</span>(tree1, tree2))))</span></code></pre></div>
<pre><code>## [1] 0.5488095</code></pre>
<p>More concisely, we can provide a normalizing function:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NyeSimilarity</span>(tree1, tree2, <span class="at">normalize =</span> min)</span></code></pre></div>
<pre><code>## [1] 0.2744048</code></pre>
<p>This approach will produce a similarity of one if one tree is a less-resolved version of another (and thus not identical).</p>
<p>If we are comparing lists of trees, this best value will depend on the number of splits in each pair of trees. We can use the function <code>pmin()</code> to select the less resolved of each pair of trees:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NyeSimilarity</span>(<span class="fu">list</span>(tree1, tree2), <span class="fu">list</span>(tree1, tree2), <span class="at">normalize =</span> pmin)</span></code></pre></div>
<pre><code>##           [,1]      [,2]
## [1,] 0.8750000 0.2744048
## [2,] 0.2744048 0.5000000</code></pre>
<p>To avoid these limitations, we may instead opt to normalize against the average number of splits in the two trees. This is the default normalization method for <a href="../reference/NyeSimilarity.html"><code>NyeSimilarity()</code></a>:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NyeSimilarity</span>(tree1, tree2, <span class="at">normalize =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 0.3991342</code></pre>
<p>Finally, if <code>tree1</code> is a “target” tree – perhaps one that has been used to simulate data from, or which is independently known to be true or virtuous – we may wish to normalize against the best possible match to that tree.</p>
<p>In that case, the best possible score is</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>TreeTools<span class="sc">::</span><span class="fu">NSplits</span>(tree1)</span></code></pre></div>
<pre><code>## [1] 7</code></pre>
<p>and our normalized score will be</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NyeSimilarity</span>(tree1, tree2, <span class="at">normalize =</span> TreeTools<span class="sc">::</span><span class="fu">NSplits</span>(tree1))</span></code></pre></div>
<pre><code>## [1] 0.3136054</code></pre>
</div>
<div id="normalizing-to-random-similarity" class="section level3">
<h3>Normalizing to random similarity</h3>
<p>The diameter (maximum possible distance) of the Nye <em>et al</em>. tree similarity metric is easy to calculate, but this is not the case for all metrics. For example, the clustering information distance metric <span class="citation">(Smith, 2020)</span> ranges in principle from zero to the total clustering entropy present in a pair of trees. But with even a modest number of leaves, no pairs of trees exist in which every split in one tree is perfectly contradicted by every other split in the other; as such, any pair of trees will necessarily have some degree of similarity.<br />
In such a context, it can be relevant to normalize tree similarity against the <em>expected</em> distance between a pair of random trees, rather than a maximum value <span class="citation">(see Vinh, Epps, &amp; Bailey, 2010)</span>. On this measure, distances greater than one denote trees that are more different than expected by chance, whereas a distance of zero denotes identity.</p>
<p>With the quartet divergence, the expected tree distance is readily calculated: any given quartet has a one in three chance of matching by chance.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;Quartet&quot;</span>, <span class="at">exclude =</span> <span class="st">&quot;RobinsonFoulds&quot;</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>expectedQD <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">/</span> <span class="dv">3</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>normalizedQD <span class="ot">&lt;-</span> <span class="fu">QuartetDivergence</span>(<span class="fu">QuartetStatus</span>(tree1, tree2),</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">similarity =</span> <span class="cn">FALSE</span>) <span class="sc">/</span> expectedQD</span></code></pre></div>
<p>The expected distance is more difficult to calculate for other metrics, but can be approximated by sampling random pairs of trees. Measured distances between 10 000 pairs of random bifurcating trees with up to 200 leaves are available in the data package ‘<a href="https://github.com/ms609/TreeDistData/">TreeDistData</a>.’ We can view (normalized) distances for a selection of methods:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">&quot;TreeDistData&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(<span class="st">&quot;TreeDistData&quot;</span>, <span class="at">exclude =</span> <span class="st">&quot;PairwiseDistances&quot;</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data</span>(<span class="st">&quot;randomTreeDistances&quot;</span>, <span class="at">package =</span> <span class="st">&quot;TreeDistData&quot;</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  methods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;pid&quot;</span>, <span class="st">&quot;cid&quot;</span>, <span class="st">&quot;nye&quot;</span>, <span class="st">&quot;qd&quot;</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  methodCol <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">pid =</span> <span class="st">&quot;#e15659&quot;</span>, <span class="at">cid =</span> <span class="st">&quot;#58a14e&quot;</span>, <span class="at">nye =</span> <span class="st">&quot;#edc949&quot;</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">qd =</span> <span class="st">&quot;#af7aa1&quot;</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  oldPar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">cex =</span> <span class="fl">0.7</span>, <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="fl">0.01</span>, <span class="fl">0.01</span>))</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  nLeaves <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">dimnames</span>(randomTreeDistances)[[<span class="dv">3</span>]])</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(nLeaves, <span class="at">type =</span> <span class="st">&quot;n&quot;</span>, randomTreeDistances[<span class="st">&quot;pid&quot;</span>, <span class="st">&quot;mean&quot;</span>, ],</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.54</span>, <span class="dv">1</span>),</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&quot;Number of leaves&quot;</span>,</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">&quot;Normalized distance between random tree pairs&quot;</span>)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (method <span class="cf">in</span> methods) {</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    dat <span class="ot">&lt;-</span> randomTreeDistances[method, , ]</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines</span>(nLeaves, dat[<span class="st">&quot;50%&quot;</span>, ], <span class="at">pch =</span> <span class="dv">1</span>, <span class="at">col =</span> methodCol[method])</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">polygon</span>(<span class="fu">c</span>(nLeaves, <span class="fu">rev</span>(nLeaves)), <span class="fu">c</span>(dat[<span class="st">&quot;25%&quot;</span>, ], <span class="fu">rev</span>(dat[<span class="st">&quot;75%&quot;</span>, ])),</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">border =</span> <span class="cn">NA</span>, <span class="at">col =</span> <span class="fu">paste0</span>(methodCol[method], <span class="st">&quot;55&quot;</span>))</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">text</span>(<span class="dv">202</span>, randomTreeDistances[methods, <span class="st">&quot;50%&quot;</span>, <span class="st">&quot;200&quot;</span>] <span class="sc">+</span> <span class="fl">0.02</span>, </span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>       <span class="fu">c</span>(<span class="st">&quot;Different phylogenetic information&quot;</span>, </span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;Clustering information distance&quot;</span>,</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>         <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">plain</span>(<span class="st">&quot;Nye &quot;</span>), <span class="fu">italic</span>(<span class="st">&quot;et al.&quot;</span>))),</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;Quartet divergence&quot;</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>         ), <span class="at">col =</span> methodCol[methods], <span class="at">pos =</span> <span class="dv">2</span>)</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(oldPar)</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>or use these calculated values to normalize our tree distance:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>expectedCID <span class="ot">&lt;-</span> randomTreeDistances[<span class="st">&quot;cid&quot;</span>, <span class="st">&quot;mean&quot;</span>, <span class="st">&quot;9&quot;</span>]</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ClusteringInfoDistance</span>(tree1, tree2, <span class="at">normalize =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> expectedCID</span></code></pre></div>
</div>
</div>
<div id="testing-similarity-to-a-known-tree" class="section level2">
<h2>Testing similarity to a known tree</h2>
<p>Similarity has two components: precision and accuracy <span class="citation">(Smith, 2019)</span>. A tree can be 80% similar to a target tree because it contains 80% of the splits in the target tree, and no incorrect splits – or because it is a binary tree in which 10% of the splits present are resolved incorrectly and are thus positively misleading.</p>
<p>In such a comparison, of course, it is more sensible to talk about split <em>information</em> than just the number of splits: an even split may contain more information than two very uneven splits, so the absence of two information-poor splits may be preferable to the absence of one information-rich split. As such, it is most instructive to think of the proportion of information that has been correctly resolved: the goal is to find a tree that is as informative as possible about the true tree.</p>
<p>Ternary diagrams allow us to visualise the quality of a reconstructed tree with reference to a known “true” tree:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>testTrees <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">trueTree =</span> ape<span class="sc">::</span><span class="fu">read.tree</span>(<span class="at">text =</span> <span class="st">&#39;(a, (b, (c, (d, (e, (f, (g, h)))))));&#39;</span>),</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">lackRes =</span> ape<span class="sc">::</span><span class="fu">read.tree</span>(<span class="at">text =</span> <span class="st">&#39;(a, (b, c, (d, e, (f, g, h))));&#39;</span>),</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">smallErr =</span> ape<span class="sc">::</span><span class="fu">read.tree</span>(<span class="at">text =</span> <span class="st">&#39;(a, (c, (b, (d, (f, (e, (g, h)))))));&#39;</span>),</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">bigErr =</span> ape<span class="sc">::</span><span class="fu">read.tree</span>(<span class="at">text =</span> <span class="st">&#39;(a, (c, (((b, d), (f, h)), (e, g))));&#39;</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="fu">VisualizeMatching</span>(MutualClusteringInfo, testTrees<span class="sc">$</span>trueTree, testTrees<span class="sc">$</span>lackRes)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">4</span>, <span class="fl">7.5</span>, <span class="at">pch =</span> <span class="dv">2</span>, <span class="at">cex =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">&quot;#E69F00&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VisualizeMatching</span>(MutualClusteringInfo, testTrees<span class="sc">$</span>trueTree, testTrees<span class="sc">$</span>smallErr)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">4</span>, <span class="fl">7.5</span>, <span class="at">pch =</span> <span class="dv">3</span>, <span class="at">cex =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">&quot;#56B4E9&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VisualizeMatching</span>(MutualClusteringInfo, testTrees<span class="sc">$</span>trueTree, testTrees<span class="sc">$</span>bigErr)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">4</span>, <span class="fl">7.5</span>, <span class="at">pch =</span> <span class="dv">4</span>, <span class="at">cex =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">&quot;#009E73&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="80%" style="display: block; margin: auto;" /></p>
<p>Better trees plot vertically towards the “100% shared information” vertex. Resolution of trees increases towards the right; trees that are more resolved may be no better than less-resolved trees if the addition of resolution introduces error.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">&quot;Ternary&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(<span class="st">&quot;Ternary&quot;</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  oldPar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">rep</span>(<span class="fl">0.1</span>, <span class="dv">4</span>))</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">TernaryPlot</span>(<span class="at">alab =</span> <span class="st">&quot;Absent information&quot;</span>, <span class="at">blab =</span> <span class="st">&quot;Shared information&quot;</span>,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">clab =</span> <span class="st">&quot;Misinformation&quot;</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">lab.cex =</span> <span class="fl">0.8</span>, <span class="at">lab.offset =</span> <span class="fl">0.18</span>,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">point =</span> <span class="st">&quot;left&quot;</span>, <span class="at">clockwise =</span> <span class="cn">FALSE</span>,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">grid.col =</span> <span class="st">&quot;#dedede&quot;</span>, <span class="at">grid.minor.lines =</span> <span class="dv">0</span>,</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">axis.labels =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span> <span class="sc">/</span> <span class="dv">10</span>, <span class="at">axis.col =</span> <span class="st">&quot;#aaaaaa&quot;</span>)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">HorizontalGrid</span>()</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  correct <span class="ot">&lt;-</span> <span class="fu">MutualClusteringInfo</span>(testTrees<span class="sc">$</span>trueTree, testTrees)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  resolved <span class="ot">&lt;-</span> <span class="fu">ClusteringEntropy</span>(testTrees)</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  unresolved <span class="ot">&lt;-</span> resolved[<span class="st">&quot;trueTree&quot;</span>] <span class="sc">-</span> resolved</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  incorrect <span class="ot">&lt;-</span> resolved <span class="sc">-</span> correct</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">TernaryPoints</span>(<span class="fu">cbind</span>(unresolved, correct, incorrect), </span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">pch =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">col =</span> Ternary<span class="sc">::</span>cbPalette8[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(oldPar)</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYAAAAGACAMAAACTGUWNAAAA/FBMVEUAAAAAADoAAGYAOmYAOpAAZmYAZpAAZrYAnnM6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZmY6ZpA6ZrY6kJA6kNtWtOlmAABmADpmAGZmOgBmOpBmZgBmZrZmkJBmtrZmtttmtv+QOgCQOjqQOmaQZgCQZjqQZpCQkDqQkGaQkNuQtraQttuQ29uQ2/+qqqq2ZgC2Zjq2Zma2kDq2kGa2kJC2kNu2tra2ttu2tv+225C229u22/+2/7a2/9u2//++vr7bkDrbkGbbkLbbtpDbtrbb25Db27bb29vb2//b/7bb/9vb///e3t7mnwD/tmb/25D/29v//7b//9v////djI4ZAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAduklEQVR4nO1dCZvjNnLVTDput+1kEqfd3hzedE+O3c16RG+OzcbrjJnDO54MW7LE//9fQoCHABJVqCqCBEnh+fOoJQokhUeiqh6KhV2ZEBW72Cdw7UgEREYiIDISAZGRCIiMREBkJAIiIxEQGYmAyEgEREYiIDISAZGRCIiMREBkJAIiIxEQGYmAyEgEREYiIDISAZGRCIiMRIAE+U7jPsCuEgF8nJ9u6z+y2/E7SwTwcfryTf3H8dO3o3eWCOAjETATwJG+GXq6oWgMEgEQsJG+oSZA/ycCQAQdaGAkAiAkAmIj5EgPIxEAI+BIDyMRMB7FmMaJgJGo75IR7cOdysbQGWEUqv+KMd2YCBgF3X1FOaIfEwFjUPdecflTuosEEZrOSwRMifzmA7jNJEDak4kAHxDRPxEwJU4PuwYvISmi6by9+YaLqydgzOyi7rz9fl/0/CCOenHlBIybXdyp7td3QHHpyPMTcs8497EtHFjizUjJc6dHH/VPYd0AjPtpYwSc/vXVh9PDI/37owjYN4NQqfrxoggdEMdpgI0RkKvB/MAYAUZozvu64zUBZjdyLoAtEVBZ0+rK0x2aMYYAqea8r30fhxiXs/a1BQJydcWpn53dfNBjyvETio7GhCU6t91fv7G+xzz4Bgj4wzfVlX9+/UYNJI915Hr+MfxhTALsLrfecQez9RNQXXGnX+m+17dB/QcVNM1Z40LA3u7/Hh1MrJ8ANYq/eFNf+Woc+umfpjlMS0C/+6+egOPd7rEyvaeH22nG/hY1AcPuv3oClN/9vhpJqgiU43/XOD3UDlPmb6oJcPb1FRNQu55V5ImJxhhOD40K5JciCvflX14zAa3NPX76HSv4ueD05de10fZHwgXQ/VdMgHJhDlr4ynYvfi7dRT0K+QmAu/kqCajGjtvzv1dj9/9xlK/hbrTxuPUPQUpzhvJ/rpKA7FFJLjr83RFGH0j1r+OA2pQg2GvFuQQouD4CDrrDDi/fZvfl4bb8re/7I58pqgd/3flOCq6NACU5K8Gzcn4Ovku3aTFSdNYorBfHF2RYIQFaclbXMjnuGkNA5/u0PT+8Ca6LgGrY7zr/X35NbCRW/Q3X89LvfQquiYDz/3zy61py5oVeMtXf8vwL4O/rIkAPP7rzT/8mi31x2KI/vKmAxWkm1kHA6WdvG2dRDyY8yZkDo1/7gW9v3DEo2D4Bp4e//bGZ8nqv7SlTcqar/l2vDnWHge3tKNg+AcritlNeUtmNhqZPXbKPw/9svz3miKsgoBp9XnzdTHlNN/woNKI/vKn3GaxRU7EKAtScSzflJZnxavxP/92jOhRQPd0yhKJg+wToVJ8xU15tnopXiiig7ocfxSuKrRKQ12ONzjVU2X6iKS+NOlelioK9kfD334P/F8i2Hjipccsl4KyyTbpcw1HTvWQCEM0ZuwPsRqeHl/9xRzZUyyWg+iW/MnINM0K+IVzeRKlH1ed40lo1+sCaM24DzI1aKXlFvQeWTED+4k3JyDXEROdsp/woNG1cD/6w5uzxgi5tdGYqXfVbKAHv9L+qJ+m5hqNE58b2wpqzNw5o3nQZYkQsk4Cmwy+qGyXXcJTo3LzCmjM1EtYHbxKkCckuCyWgGs31aJHrpBOqQQsgOsOaM1ULOughU/X88e7mB78xXiYBOvIqm/uZHnmNF50tzdnucvidTUA9Wdo8J+M3xgskQDv+jSs9TaKn1Xt7aEuPApgbOxDLdKpqMyJqGRfF4ghoHH/Wc1ZcmKIzuKX/njsjpu9ev/ixOAJax//46X8yk/xDiM6wpWXNCWsnrhpHd/6UmcUR0Dn+GedhTx5g0dnla9quKSUrQslW+mcQtPMFEdCkR033kFGHOnxyjRzuEKzoNtHzglQkcHjh/xXLIUBdLdp9kz9kdH6iZMk1ojO4BfiYmxnXGmMPFkOAslmH3Z//fsyMb2W5KbEPIjrDilu57dzQfPfis6/ubj7oEF7seyrX6Xjnd59AzR+pvwfLpBsgQMWuP7xWNpf3jO1wPzppxXfnI6IzLEYXW74DdLx4frr5QLG9oOZMqC+jgIrOkA0oahsA7NFzxiiiEtDMeTVd9+IzwowXmuhMiN48orPHC3LTtloCzt+8fGuk5mcU2zsy0dknOiOk1C8uClZLQHXF/tmr2vesvE5aiY1xon/zCge1DhW66G3aSHZ0neSpXRYlnme0RP9yTHkTiug80IIKx6b+l1ZJwOGjJ9XjdcDO6ktheRNQdLa+hfBh6nIbyI6uHJ+schfrOa9phE+i6Axqzr1+3lh2tBLK1TCUv3w7le5DFp2d44xvdFp7dvT59RvlfN5ys60k5U0YonMx+ITQaJUEKLP7qHKYvp0s2ZknOttbaB6qlRUhRDQCmoH/9LvJjsATnQ3NmR6jrTk7mlVa0IDyP493lEKrXNG50Rt4KsV6s6M5pQ1N6CS57D73z5cJRGf1H1enW2t29PFPfy9pVhvh6vbxR8JwNnMhyYC+uuxoN8gEYNU1UNEZ3Aa22WR2NCg6a+OdPfq0ILS6Biw6w22uKzvat47jo0eMk4jO7cQvtnnwWecFbSw7OoboLHBDrTigebON7OiJq2vAojPcRpIdTXmkdpkEjBGdu78kojOsOfOzo89P682OjiY6k8U4UA3tsqNpTwUulgAqrG4ZLzoT5WhKdrR+tv+qCKBX14Cvc7gNNztarWRCWZtmmQQIEp2H3SARnZGRH7bPzuxoZYAp0cAyCaCj80TCiM6wf8TOjr6nJVlug4BgojPcBonrnEOQMsaUub6lEnDwp7hpaM05nOiMBMGwSgFmR1OcuIUSoEZQpbh5/WhEjsdEZ1AOAj4ummZOrFOORlEbYSW5+cwYXFJbpHmKdNLtEnBv+9HPwy/C3Z8IoACtrqFYMNWU5yEDe+SxCZHofF1DkK+6xhuVNXT5aEAAXlJbJDoHNMJExCSAp3k+l/Yg5CupHdkNpWKtBLSDPxweiURnUSD2hePgZES1ARzR+dn417joGAK+U3QmC9XIkdZLAEN0fjZfSSW1aaIzWahGjrRiAqgoTALgktpIZ04pR18DAZfB/xkpqV1CPUYWneE2yJFWSwBDdO4I2PdcUbgvRaKzkwrfkVZLAB2d7d334+FhPw06kyM6M2z65TtXQ0A9+HsI6Hcmz9uH2yDTC+snwBcHPKtf2tleiwEkBNMxLyfeLbA2CGurJeD00Dwd4yHguSc6mwzAfckXnVGhGjnSagko2+p8fgIs19NPQImXN4E+FybnrpmACpkqT4YR8FyNPnY6+DNWZJuQTo6lp5NT179woT7jlaWnnx6+wgkYiM7GLRD0DhAMQfoOWHp6Oqj6t0ALcz+70G1FRnmuDRA/ovSFvXFp6enjFnL0ic5uL6dzKcMJ1R4vaMHp6SEynXthkoFAcYAkEOvFAc2b5aWnywkYVtfgPD7NajTcwjiS5QVZ6ekEnXcGGyBNNXcmOnsFfGcj+Eu9fZLFOFALuqSnK/gXO57RCHv73/qJRNHZ7hZIWg4gVCObbAK69HSN04Ojgl1e0VJFQJqlBbihHYwftaeKzjA1xG5G2iBHsr5lB2JWvdDcVQkjrxdDroeGRRLgq64BjBmCRoIpyWEjMBKuIgKH2dNmWqWNanMxoxH2ov1dhERnQqY5wdRKJuVJc8L1CiwHd+jTrQsyEwF01L+Mt45j+yJwNiVpKc5vONPTVf+7DbAmoIvWlkaAO9fQEzmJwi1yG/P7jLwgOLG46nzlp9ZFNucgoDJLL797CF9do9MOBI0kqYm8zLifvnXvq9Qdct+65XPEAff17XjwLuTITnQuCkl5E6lQDW1ceGZct5aKv7wGuAnsF7j70c4UHAhptQYC/M/M7rFMZ+QOEMygCO8AcCOTALvGdTACYM2ZNAQ11TWYQzPWJrYN8KBdnTEQAajmrMrivkeNsFx0nsML8vlbIgLa8SAQASHWcRSJznAbb/BAjgN8ZycioNWL4hMgEp0v3wXbEMLnQJGwzAY0UUIoGyBfx/HyJ6y29H8zJdN8Pi1oGV7Q+HUcRaIz3CaAGgo3sr63DALIMM49gOiM9Tnxa+D3UG6Mv7kEVNfqY/cQfUQCgojOcBv6QDN2RoxrA758c3z1oc0dCm2E/WhPPIzoDLfhmFqZug3/EhRVX51+9jawG8pAfdqhRGfYQR3l1RIb1S/sIej2/PQY2A1lQJ11ONEZCackjQrPdufZydzQsJFwtdd7vX6r3wsKKzrDbdiCgzgzbglekF5E8FPSUnhhRWe4jUzbE6jbiyjeres6qL73RsL9TGfS/2jh7IDZ0eJzsIFnRzdDUFgboCoEHggEBBedoc9LiVBdIpozdgfYR6JlR7facCgbUO1PkYCviLQPLzpDbXQj5rhVzFm8O7gbevDloFs1loOJznAbxKBKDuTxgi5tFpcd3WIa0RkhBXYp4c9GxAHNG0J2tC4p2pqJuQiYSnR2tOk1IkVvRZ9iQiN3JGxmR7txflKBWB5WivDAXdI5hOgMt2HoFyPVbbB4t3tIrjzGioBZpQiwpLP9o3rvCvcWTA2Fdo4J1ePVbXfxbj01orJB+qhipunvAOv8ENGZqLjDXQHvDZGWiW+okwju4t35zd/fu0XK05dfP01tA4z7c1rRGb7Madc5em8Ap0SaEavCrcecsE7gxARQSjqPEp3hNpSRPoy67SzerYehzL/e3LQEEEs62y4IUXS2t5D8xr5QTTtQr9HwG87saO2IAgRk07uh+jSnFZ2NNoxGg3/9bWR5QSoWdhfvrhMXssmN8Dyic1ECvYJ1JtzIvaf2zIADuX9oDukCtWEe44YSFgcSlHTGFnIE27QcMBoVsgMhIiJ/RqwcmZrof+ZdWNKZ3UbUSHggcNN8ybl2UxjYOo5ovzAvZrRNWALW9HyAqKQzrgVL2oQcgpqRDti6MAIkJZ1NLZjc5mK0JQfitkEaLYoA7zqOiKsNu5Q+N5TsUkrcUOsQrrNbEAGEdRxd8ZG3kTemEonOrDasSJiBkASISjqPFJ3HHYjRhqsFURGQADDR2f6a/RbUgpE2bols0DGkA5HbIGcnc0ObUnmjCDDPg7qOI9JlcCPilhLZ3dg3yDnEuwMuZ0FfxxG6fNFG1Et29HUOt0GOFJ+Aoe4wNKOCAbgcthkO0iEORGmDHEk6BOl3IQhgJTqLXBCOfzTK14HbID8p3mOq+gSY6zhynfDCaEPrFvsQ5AN52iBnF+8x1UKwjiM3DPWIzuEO5GmDHCneY6qw6Ow+21KoBZcFuDHkgdA2yJHiPaa6F2QZF4JMZ0kbae3o6bOjbYwgoIAftQAvl1KsBc91IHh/YBtRdvR4G1AflGUDNjgENTbA3OjLjr7MqjCqJqo0O4vUy3mSvaANGuGLF3RpRMyOrr7BkSLUyrJ3xhSzdTa0OGCDbqgVBzRvGLWjGQToZy8OjhqwzRn4I2EjmGpeBPHRsgIxdyRs1Y4OtqR5TSsyF+/RgsyfVAw/AhsNt/jbCA4kkSIgLcioHX14+dfOxBTJ8wE6E8WdZ+Q6C+RsS/efeKPC+SnjQFgjiRgHq6GX2tGqu04PQ49UlJhV31MZ5lyBhU82KEfbW9zZ0cc7IHdElphFyTV1zoh5rvM1TsiQZ8TcVlOYmuhd7EifSn9OWDYAL3pKcmgdnNnROewMCZ8RO7gqsQ9gP4lHdEH6rwRfx+8fiXwduE1ZQN9wZ0drj4WwbE7wvCCjAKLzbBHHsTDf+NpYEUIwbx/5rIBOzj0EKWMMl4++YLrMOOBsPWEoOQhqPhUfiNtGbQJiZLcNyMDs6ClKFfTOaA+fLdCZtRDD0+LxNmgjfhtEqJPNBwQuVdDDHjxb6DeWIs1zzuRcaNMiCrf2UAieDxD1S+jOnI+AFlMQ0GiErCdk1OfLfUAj6BAU3Ab0wgOPUA0Z1MIwqtw2jEbzGWEPshBTkjXstWqsc+QlTMAejc8NpTca/Ettw3VDfQhoA7KvYJGO8pxw35knxUf9AIAUPMwViFEQrmri8dUHLODzPSk//ImOnpG0iSlFoJigeDdanaV/fr3zB0RnSRu0UQwxDkM+LjOuN0eMP7hKTZwuoA2INgrvrQz7Bj5qFBvQmyOul8SC4a4XhP1E8JJFqYF2PuOEDBXjbMBgjhieL24wrJjlGzOcgzajjWikp5sUaErSjxA2wDtH7ID/8THYKWG16bstHF8HboM4AjEi4csccea79jt4H6B0fWS57LQ29rd53j7cBjl4DAIIc8QOtHVD3ZeYJ3TlthHFu3AbJBiMsoADtR5RD6pyLusn1h/z2+hGIYVqRA6Js4ADaY7YAaSMBPj5EoRq5OwiLeBAmyMeYsnFu+dJT4+6gIO+ZblCdTFP+XrJEKTvALuNLz19mgUcXFDhsn0ttGfKfa6pgLeCbbiGQ2KEOxtgbqQV724xJQHZvR0im7HLlEK16UwGE6o9XtDlOPT0dP06IQG6aqyRmmT/ggmF6l4jcK9IG2KUUr8w09N1XlY3JzYlASpWQDzViYVqRvgskSKgSNhfvLvLDT3/WE5uhLVoBGJSoZosIEnEOHs8NT8/mImf5fHz0oPgBNhCtccYIUI1qJpShWqq7Ep8g7wD0tP1ohZ4cb1yAgJsobp655mtgYRqrCuAGwITnaGJB8mETL+VOz29zHe3TlscsFyNA7ZQfX799dPu8R3aYiqhmjKiSaYkh63cuaG7e+80iUJwAiyhuiKbIFlPI1T7bbpoUp40J/yuPP/D3c0HygPbwYcgS6g+/yMpHplEqPZ6tbwIATmSMz29Fj0du5t6DZnFCNWeuI4rVCNHgsS4fBfyCRkypEJ1GVioRpUNvlBdbfrYavVx9xdAAPRM4/ji3R4IhWqs3jH4uUR0RgQ3XKguPjY+MP4GCPjfb92fT1++XixU8zOqkb7EOpPfpm516XWTC+6MWJR1xPwILVRjorNsfsdgwOz/5aWn+zGo/TGBUI1bbskMp3qpe97q/zUSUNnogxmkTyFU+0RnuhdUmkdSfW/3f/TnA/hQQrW5wpb9swMJ1V7Rmag59yOOj/v9H7FqohQqVgDDlDKQUE3QLyR5XrYvpBH7+QARjp+jT9EGEKpJCh5ddOo2VXdA71uRnw8gY2B5sWmj8UI1UWdG2ji/qG1Ab8wsWZjg+QAa+lW38NW3RwvVVNEZ1JydR2q8IGvTSrwgW6iurn60/JCCSKh2/CkRqoEjXeIAaEaMixkJsITqPzxRwmWBUD0wtSSherjF+R0rEnbPCXMx4xA0c0Y1S3TuZUUArPW1IDR4JGJGAmYWqpmisxHXQUey/c+Puy+uhYCZhWq26NwpG5wjNZlxcswaB8wqVAtEZ6xEL3Kk9RCwlIxqLDtalDnd/5nzFO+eDTKhWio6g9vANqLi3S1WQADqa8AjMzKcBByCGhtgblxOdrQMvWSay9UlWSuFMfUuMcIXL+jSiJgd3WJ5BJwezCjB+tksoVokOqNuKPSRtHi3xgIJ+Kt/pteoJkTCrrBr+AkpEAOOBGZHZzESs0bj+Oo9lk1KFqrpWhBdinAfCciOPj3cEupWLpCAz8v8j/4SmSogCtVUNZQlxjnfgdnRFGO8DALMqYLqEsp291hCL02oFonO8BbkSEB2tII/IlgGAeZUweFPdrcHT1q9q0q4V3R2b8HvDeffpOzoUj8eAE+7tlgEAdZUQU5RjCQrRw/Ns2+ccY5OtOxoVbz7HcUZXQYBkuIrPqFa5OvAbZAjgcW769+FYxEEiKYKfEK1yNv3xHWM7GhdvNs351cuhQDZVAEuVEPxbruFEyM3/wBHYhbvtrEMAuTFV/jqWSGrEl4LRe6zwE7Rh4UQIC++Av96mJnAOukmCJBNFWBCdSJgAvzGvkcsMWwAuJMLeKwBPt7+EERBvvvj3xlvPUK1SHQOaISJWA8Bxzs7PLbVAEcnxHVDqVgPAR4vlbOeZQF+I0wgxsGKCDjc5s0avG5MU3xl8BdFimBgRQTodRmxyhO9m0AiOsNtBGIcCUsnwBSqdaCGTvYR17OcVI5mYukEMHPaS2iqwPoSSagWTshwsXACZsppdwnV/R3Do9OmCejntHsLIF0okIjOcBvqpDwXCydghFCN+I2SCMGbliLE0gmQC9VI5CQRqhHWNk3ArFXCBUtTris9XQS5UD1bcm7/o41lRwtz2ovvv99HKd69uexoEdDRGROqBY+C9G61tWdHC5D1JaKLhxhMqMZtgNFm9dnRfFTB8fm/3bVXwgnVPi+obbP+7Gg28PLIrnFIIlRT4wAjO/r8tMrsaDbUchS4Tj1J8RUgEr5kRx/vbm0Zy4kNEFDmH/3dW7xCcgChmqoF2dnRuoQ/ivUScBGq9USBZ9gdLVQjm5DsaLMslRvrJcAQqnU+r0enHitUIzcHEgn7n5GJT0B/sp0IS6hW0bI3D3OcUI0o1c7s6Do73W+F4xOQUep7D2EL1TkpWh4jVHPmhE8Pt6cHinJeLoCAw8tfsJU2jfmEavPFFSK4hqCM2P/RCTg/3Wut2W+t+phPqL7EaO4g2W0DDrQ7OzYB+c171fXHO77iNq9QjeQzQkY4o9wEkQmoLmOlWx1e/LI62YP/iSoLcwvV0MY1zwdURrQKHQ8vv0MXmoEgFaoLfkY1rJKumgBlQ/P7ypwqi5qL3FEfBuu4yIRqrPjKiglQUG6oIgJfbUmKvPeckEiobqeLN5kdra9Q5c7nt7ksIkBwvLv5YPpJIqHaVKo3mh2tboDjJ5UdrkchrjEGoXxb7FFRmlBtRw3EOICMRRCgfMnsXtHA9yp9QJ/VFRVf8UfCHCyCgLJWdfIXb9T6loGNMc4pLlS700a3mR2trlTd9ZUxzmWl/Yx9GUUafLODsFANK9WbzI6uDLF2hPJbXV58jBmwUqr9STqC4iubzI7OtHpbWQLlEymd4fxEV9lM2CnVBJWJIlRfTXZ0bYwVAb/Nb36QKA392h+UIiB+ofpasqOrjldWs4oOTr8RD0PyMuGwr3k92dFa5FRdmN2zteYGwjLhJRZtXVd2tOpBTcQ3IiMgVKpRofq6sqOrYVtJFIfdR0I7PKJMOLQN1uk2SECpByE9knBSvQ0IleoQ2dHbSE/XS40p90VdyGMDMypExVc2XLy7fi5Y3QmU/A4uVLhsW4nWqeGWCd9Y8e4LDs2T8eoX/RScABUum7lEZmTFKxO+seLdBuqya3U3hR6GtFRt5FV7k918cUDzZoPp6XokGq0PDXd7i61nSSi+4o6EzeLdFCyfgDrVuJ4zC7pjPRcKW8s+BdTsaHO98nr1chTLJ0Cj1hXQpwBIMIVqfa0K17OEs6Mv6enqWP6pjZUQoIYh1WH8BLrBfjqh2kuA3bVwSjWYnj7IyHBgHQTU4vS9/oNQkx+EJVSr8cGXU23cBIIZMUpAtg4CFNSvqVyMyr5lYmtsC9VnynqWhDLhQHo6zRSvhgDdd40vqm4IWRqRSKiuXxhZEap4d0l0GlZDgIK++qsRtiLgnZ42Y98KIqHamCrg5AVRSnevjID8ts702d2fXguHIbFQzc6MI7igCqsioPErqnGkev3mjSh/ZYL1LLcpR0PIdEQstwLy9SwFWwhYHQHaHWryV6QTZgJUlz8oVF8bAWXtzBw/+aV4woyLZvQBKLhCApTWkv3FiAkzFP2ZAp9QfYUElPnj4eUv2gmz0KicJFNE8ArV10iAQjthFnqqQOtNB3BsG94E10pAO2EWeqrgVD+2Sa++cq0EtOsUtamkwaCzwn6O6a42BVdLQI02lXTkbqwq4YpYz3IFwN9srJ+AJpU0wG7s8koewci4Ca6bgC6VdBx6Ke1/Q3CvOgqumwCFAE+42jMF//UZqdbG3nqRYRME8JYBdWNE8ZVEQAhIi6/sEwGBICy+UlGQCAgDafGV4R2whezoGJDNFBT9etPbyY5eA8xl9hpsJzt6geiNUUYhg01mRy8PB3uioBy+2WB29JKQfeXLNdledvSSUA3tvqDPyo4mIBHAhO/itot3+5EI4MIn/FnFu/1IBHARQPo2kQhgA54uliAREBmJgMhIBERGIiAyEgGRkQiIjERAZCQCIiMREBmJgMhIBERGIiAyEgGRkQiIjERAZCQCIiMREBmJgMhIBERGIiAyEgGRkQiIjERAZCQCIiMREBmJgMhIBERGIiAyEgGRkQiIjP8HoFrJa2qYJosAAAAASUVORK5CYII=" width="50%" style="display: block; margin: auto;" /></p>
<div id="example" class="section level3">
<h3>Example</h3>
<p>Here’s a noddy real-world example applying this to a simulation-style study.</p>
<p>First, let’s generate a starting tree, which will represent our reference topology:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>trueTree <span class="ot">&lt;-</span> TreeTools<span class="sc">::</span><span class="fu">RandomTree</span>(<span class="dv">20</span>, <span class="at">root =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Then, let’s generate 200 degraded trees. We’ll move away from the true tree by making a TBR move, then reduce resolution by taking the consensus of this tree and three trees from its immediate neighbourhood (one NNI move away).</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>treeSearchInstalled <span class="ot">&lt;-</span> <span class="fu">requireNamespace</span>(<span class="st">&quot;TreeSearch&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (treeSearchInstalled) {</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(<span class="st">&quot;TreeSearch&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>, <span class="at">warn.conflict =</span> <span class="cn">FALSE</span>) <span class="co"># for TBR, NNI</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  oneAway <span class="ot">&lt;-</span> <span class="fu">structure</span>(<span class="fu">lapply</span>(<span class="fu">seq_len</span>(<span class="dv">200</span>), <span class="cf">function</span>(x) {</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    tbrTree <span class="ot">&lt;-</span> <span class="fu">TBR</span>(trueTree)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    ape<span class="sc">::</span><span class="fu">consensus</span>(<span class="fu">list</span>(tbrTree,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">NNI</span>(tbrTree),</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">NNI</span>(tbrTree),</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">NNI</span>(tbrTree)))</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  }), <span class="at">class =</span> <span class="st">&quot;multiPhylo&quot;</span>)</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">&quot;Install </span><span class="sc">\&quot;</span><span class="st">TreeSearch</span><span class="sc">\&quot;</span><span class="st"> to run this example&quot;</span>)</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Install &quot;TreeSearch&quot; to run this example</code></pre>
<p>And let’s generate 200 more trees that are even more degraded. This time we’ll move further (three TBR moves) from the true tree, and reduce resolution by taking a consensus with three trees from its wider neighbourhood (each two NNI moves away).</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (treeSearchInstalled) {</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  threeAway <span class="ot">&lt;-</span> <span class="fu">structure</span>(<span class="fu">lapply</span>(<span class="fu">seq_len</span>(<span class="dv">200</span>), <span class="cf">function</span>(x) {</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    tbrTree <span class="ot">&lt;-</span> <span class="fu">TBR</span>(<span class="fu">TBR</span>(<span class="fu">TBR</span>(trueTree)))</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    ape<span class="sc">::</span><span class="fu">consensus</span>(<span class="fu">list</span>(tbrTree, </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">NNI</span>(<span class="fu">NNI</span>(tbrTree)),</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">NNI</span>(<span class="fu">NNI</span>(tbrTree)),</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">NNI</span>(<span class="fu">NNI</span>(tbrTree))))</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  }), <span class="at">class =</span> <span class="st">&quot;multiPhylo&quot;</span>)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now let’s calculate their tree similarity scores. We need to calculate the amount of information each tree has in common with the true tree:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (treeSearchInstalled) {</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  correct1 <span class="ot">&lt;-</span> <span class="fu">MutualClusteringInfo</span>(trueTree, oneAway)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  correct3 <span class="ot">&lt;-</span> <span class="fu">MutualClusteringInfo</span>(trueTree, threeAway)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The amount of information in each degraded tree:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (treeSearchInstalled) {</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  infoInTree1 <span class="ot">&lt;-</span> <span class="fu">ClusteringEntropy</span>(oneAway)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  infoInTree3 <span class="ot">&lt;-</span> <span class="fu">ClusteringEntropy</span>(threeAway)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The amount of information that could have been resolved, but was not:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (treeSearchInstalled) {</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  unresolved1 <span class="ot">&lt;-</span> <span class="fu">ClusteringEntropy</span>(trueTree) <span class="sc">-</span> infoInTree1</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  unresolved3 <span class="ot">&lt;-</span> <span class="fu">ClusteringEntropy</span>(trueTree) <span class="sc">-</span> infoInTree3</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>And the amount of information incorrectly resolved:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (treeSearchInstalled) {</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  incorrect1 <span class="ot">&lt;-</span> infoInTree1 <span class="sc">-</span> correct1</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  incorrect3 <span class="ot">&lt;-</span> infoInTree3 <span class="sc">-</span> correct3</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>In preparation for our plot, let’s colour our one-away trees <span style="background-color:#F5CCB599"> orange </span>, and our three-away trees <span style="background-color:#9CE0E699"> blue </span>:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>col1 <span class="ot">&lt;-</span> <span class="fu">hcl</span>(<span class="dv">200</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>col3 <span class="ot">&lt;-</span> <span class="fu">hcl</span>(<span class="dv">40</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>spec1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">col2rgb</span>(col1, <span class="at">alpha =</span> <span class="cn">TRUE</span>), <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">181</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>spec3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">col2rgb</span>(col3, <span class="at">alpha =</span> <span class="cn">TRUE</span>), <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">181</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>spec1[<span class="dv">4</span>, ] <span class="ot">&lt;-</span> spec3[<span class="dv">4</span>, ] <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">180</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>ColToHex <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">rgb</span>(x[<span class="dv">1</span>], x[<span class="dv">2</span>], x[<span class="dv">3</span>], x[<span class="dv">4</span>], <span class="at">maxColorValue =</span> <span class="dv">255</span>)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>spec1 <span class="ot">&lt;-</span> <span class="fu">apply</span>(spec1, <span class="dv">2</span>, ColToHex)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>spec3 <span class="ot">&lt;-</span> <span class="fu">apply</span>(spec3, <span class="dv">2</span>, ColToHex)</span></code></pre></div>
<p>Now we can plot this information on a ternary diagram.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (treeSearchInstalled <span class="sc">&amp;&amp;</span> <span class="fu">requireNamespace</span>(<span class="st">&quot;Ternary&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">ncol =</span> <span class="dv">2</span>), <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">2</span>))</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  oldPar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>))</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">TernaryPlot</span>(<span class="at">alab =</span> <span class="st">&quot;Information absent in degraded tree&quot;</span>, </span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">blab =</span> <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">Correct information in degraded tree&quot;</span>, </span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">clab =</span> <span class="st">&quot;Misinformation in degraded tree&quot;</span>,</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">point =</span> <span class="st">&quot;left&quot;</span>, <span class="at">clockwise =</span> <span class="cn">FALSE</span>, <span class="at">grid.minor.lines =</span> <span class="dv">0</span>,</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">axis.labels =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span> <span class="sc">/</span> <span class="dv">10</span>)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">HorizontalGrid</span>()</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  coords1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(unresolved1, correct1, incorrect1)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  coords3 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(unresolved3, correct3, incorrect3)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ColourTernary</span>(<span class="fu">TernaryDensity</span>(coords1, <span class="at">resolution =</span> <span class="dv">20</span>), <span class="at">spectrum =</span> spec1)</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ColourTernary</span>(<span class="fu">TernaryDensity</span>(coords3, <span class="at">resolution =</span> <span class="dv">20</span>), <span class="at">spectrum =</span> spec3)</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">TernaryDensityContour</span>(coords3, <span class="at">col =</span> col3, <span class="at">nlevels =</span> <span class="dv">4</span>)</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">TernaryDensityContour</span>(coords1, <span class="at">col =</span> col1, <span class="at">nlevels =</span> <span class="dv">4</span>)</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">&quot;kdensity&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(<span class="st">&quot;kdensity&quot;</span>)</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>    HorizontalKDE <span class="ot">&lt;-</span> <span class="cf">function</span>(dat, col, <span class="at">add =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>      lty <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>      lwd <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>      kde <span class="ot">&lt;-</span> <span class="fu">kdensity</span>(dat)</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>      kdeRange <span class="ot">&lt;-</span> kdensity<span class="sc">:::</span><span class="fu">get_range</span>(kde)</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (add) {</span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">lines</span>(<span class="fu">kde</span>(kdeRange), kdeRange, <span class="at">col =</span> col, <span class="at">lty =</span> lty, <span class="at">lwd =</span> lwd)</span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plot</span>(<span class="fu">kde</span>(kdeRange), kdeRange, <span class="at">col =</span> col, <span class="at">lty =</span> lty, <span class="at">lwd =</span> lwd, </span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>             <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>      <span class="co"># abline(h = 0:10 / 10) # Useful for confirming alignment</span></span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">1.8</span>, <span class="dv">0</span>, <span class="fl">1.8</span>, <span class="dv">0</span>)) <span class="co"># align plot limits with ternary plot</span></span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">HorizontalKDE</span>(correct1 <span class="sc">/</span> infoInTree1, col1, <span class="at">add =</span> <span class="cn">FALSE</span>)</span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">HorizontalKDE</span>(correct3 <span class="sc">/</span> infoInTree3, col3, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mtext</span>(<span class="st">&quot;\u2192 Normalized tree quality \u2192&quot;</span>, <span class="dv">2</span>)</span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(oldPar)</span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">&quot;Install </span><span class="sc">\&quot;</span><span class="st">TreeSearch</span><span class="sc">\&quot;</span><span class="st"> and </span><span class="sc">\&quot;</span><span class="st">Ternary</span><span class="sc">\&quot;</span><span class="st"> to generate this plot&quot;</span>)</span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Install &quot;TreeSearch&quot; and &quot;Ternary&quot; to generate this plot</code></pre>
<p>In the ternary plot, the vertical direction corresponds to the normalized tree quality, as depicted in the accompanying histogram.</p>
</div>
</div>
<div id="what-next" class="section level2">
<h2>What next?</h2>
<p>You may wish to:</p>
<ul>
<li><p>Explore the <a href="https://ms609.github.io/Ternary/">Ternary package</a></p></li>
<li><p><a href="https://ms609.github.io/TreeDistData/articles/09-expected-similarity.html">Interpret tree distance metrics</a></p></li>
<li><p>Review <a href="https://ms609.github.io/TreeDist/index.html">available distance measures</a> and the corresponding <a href="https://ms609.github.io/TreeDist/reference/index.html#section-tree-distance-measures">TreeDist functions</a></p></li>
<li><p>Construct <a href="treespace.html">tree spaces</a> to visualize landscapes of phylogenetic trees</p></li>
</ul>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="unnumbered">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-Nye2006" class="csl-entry">
Nye, T. M. W., Liò, P., &amp; Gilks, W. R. (2006). <span class="nocase">A novel algorithm and web-based tool for comparing two alternative phylogenetic trees</span>. <em>Bioinformatics</em>, <em>22</em>(1), 117–119. doi:<a href="https://doi.org/10.1093/bioinformatics/bti720">10.1093/bioinformatics/bti720</a>
</div>
<div id="ref-Smith2019" class="csl-entry">
Smith, M. R. (2019). Bayesian and parsimony approaches reconstruct informative trees from simulated morphological datasets. <em>Biology Letters</em>, <em>15</em>(2), 20180632. doi:<a href="https://doi.org/10.1098/rsbl.2018.0632">10.1098/rsbl.2018.0632</a>
</div>
<div id="ref-SmithDist" class="csl-entry">
Smith, M. R. (2020). Information theoretic <span>Generalized Robinson-Foulds</span> metrics for comparing phylogenetic trees. <em>Bioinformatics</em>, <em>36</em>(20), 5007–5013. doi:<a href="https://doi.org/10.1093/bioinformatics/btaa614">10.1093/bioinformatics/btaa614</a>
</div>
<div id="ref-Vinh2010" class="csl-entry">
Vinh, N. X., Epps, J., &amp; Bailey, J. (2010). <span class="nocase">Information theoretic measures for clusterings comparison: variants, properties, normalization and correction for chance</span>. <em>Journal of Machine Learning Research</em>, <em>11</em>, 2837–2854. doi:<a href="https://doi.org/10.1145/1553374.1553511">10.1145/1553374.1553511</a>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
